{"ast":null,"code":"'use strict';var _interopRequireDefault=require(\"@babel/runtime/helpers/interopRequireDefault\");Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=useAnimatedProps;var _objectSpread2=_interopRequireDefault(require(\"@babel/runtime/helpers/objectSpread2\"));var _AnimatedProps=_interopRequireDefault(require(\"./nodes/AnimatedProps\"));var _AnimatedEvent=require(\"./AnimatedEvent\");var _useRefEffect=_interopRequireDefault(require(\"../Utilities/useRefEffect\"));var _NativeAnimatedHelper=_interopRequireDefault(require(\"./NativeAnimatedHelper\"));var _react=require(\"react\");var _useLayoutEffect=_interopRequireDefault(require(\"../../../modules/useLayoutEffect\"));function useAnimatedProps(props){var _useReducer=(0,_react.useReducer)(function(count){return count+1;},0),scheduleUpdate=_useReducer[1];var onUpdateRef=(0,_react.useRef)(null);var node=(0,_react.useMemo)(function(){return new _AnimatedProps.default(props,function(){return onUpdateRef.current==null?void 0:onUpdateRef.current();});},[props]);useAnimatedPropsLifecycle(node);var refEffect=(0,_react.useCallback)(function(instance){node.setNativeView(instance);onUpdateRef.current=function(){scheduleUpdate();};var target=getEventTarget(instance);var events=[];for(var propName in props){var propValue=props[propName];if(propValue instanceof _AnimatedEvent.AnimatedEvent&&propValue.__isNative){propValue.__attach(target,propName);events.push([propName,propValue]);}}return function(){onUpdateRef.current=null;for(var _i=0,_events=events;_i<_events.length;_i++){var _events$_i=_events[_i],_propName=_events$_i[0],_propValue=_events$_i[1];_propValue.__detach(target,_propName);}};},[props,node]);var callbackRef=(0,_useRefEffect.default)(refEffect);return[reduceAnimatedProps(node),callbackRef];}function reduceAnimatedProps(node){return(0,_objectSpread2.default)((0,_objectSpread2.default)({},node.__getValue()),{},{collapsable:false});}function useAnimatedPropsLifecycle(node){var prevNodeRef=(0,_react.useRef)(null);var isUnmountingRef=(0,_react.useRef)(false);(0,_react.useEffect)(function(){_NativeAnimatedHelper.default.API.flushQueue();});(0,_useLayoutEffect.default)(function(){isUnmountingRef.current=false;return function(){isUnmountingRef.current=true;};},[]);(0,_useLayoutEffect.default)(function(){node.__attach();if(prevNodeRef.current!=null){var prevNode=prevNodeRef.current;prevNode.__restoreDefaultValues();prevNode.__detach();prevNodeRef.current=null;}return function(){if(isUnmountingRef.current){node.__detach();}else{prevNodeRef.current=node;}};},[node]);}function getEventTarget(instance){return typeof instance==='object'&&typeof(instance==null?void 0:instance.getScrollableNode)==='function'?instance.getScrollableNode():instance;}function isFabricInstance(instance){var _instance$getScrollRe;return hasFabricHandle(instance)||hasFabricHandle(instance==null?void 0:instance.getNativeScrollRef==null?void 0:instance.getNativeScrollRef())||hasFabricHandle(instance==null?void 0:instance.getScrollResponder==null?void 0:(_instance$getScrollRe=instance.getScrollResponder())==null?void 0:_instance$getScrollRe.getNativeScrollRef==null?void 0:_instance$getScrollRe.getNativeScrollRef());}function hasFabricHandle(instance){var _instance$_internalIn,_instance$_internalIn2;return(instance==null?void 0:(_instance$_internalIn=instance['_internalInstanceHandle'])==null?void 0:(_instance$_internalIn2=_instance$_internalIn.stateNode)==null?void 0:_instance$_internalIn2.canonical)!=null;}","map":{"version":3,"names":["_interopRequireDefault","require","Object","defineProperty","exports","value","default","useAnimatedProps","_objectSpread2","_AnimatedProps","_AnimatedEvent","_useRefEffect","_NativeAnimatedHelper","_react","_useLayoutEffect","props","_useReducer","useReducer","count","scheduleUpdate","onUpdateRef","useRef","node","useMemo","AnimatedProps","current","useAnimatedPropsLifecycle","refEffect","useCallback","instance","setNativeView","target","getEventTarget","events","propName","propValue","AnimatedEvent","__isNative","__attach","push","_i","_events","length","_events$_i","_propName","_propValue","__detach","callbackRef","useRefEffect","reduceAnimatedProps","_objectSpread","__getValue","collapsable","prevNodeRef","isUnmountingRef","useEffect","NativeAnimatedHelper","API","flushQueue","useLayoutEffect","prevNode","__restoreDefaultValues","getScrollableNode","isFabricInstance","_instance$getScrollRe","hasFabricHandle","getNativeScrollRef","getScrollResponder","_instance$_internalIn","_instance$_internalIn2","stateNode","canonical"],"sources":["/Users/sarahfitzgerald/SolStocksMobile/node_modules/react-native-web/dist/vendor/react-native/Animated/useAnimatedProps.js"],"sourcesContent":["/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * \n * @format\n */\n\n'use strict';\n\nimport _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport AnimatedProps from './nodes/AnimatedProps';\nimport { AnimatedEvent } from './AnimatedEvent';\nimport useRefEffect from '../Utilities/useRefEffect';\nimport NativeAnimatedHelper from './NativeAnimatedHelper';\nimport { useCallback, useEffect, useMemo, useReducer, useRef } from 'react';\nimport useLayoutEffect from '../../../modules/useLayoutEffect';\nexport default function useAnimatedProps(props) {\n  var _useReducer = useReducer(count => count + 1, 0),\n    scheduleUpdate = _useReducer[1];\n  var onUpdateRef = useRef(null);\n\n  // TODO: Only invalidate `node` if animated props or `style` change. In the\n  // previous implementation, we permitted `style` to override props with the\n  // same name property name as styles, so we can probably continue doing that.\n  // The ordering of other props *should* not matter.\n  var node = useMemo(() => new AnimatedProps(props, () => onUpdateRef.current == null ? void 0 : onUpdateRef.current()), [props]);\n  useAnimatedPropsLifecycle(node);\n\n  // TODO: This \"effect\" does three things:\n  //\n  //   1) Call `setNativeView`.\n  //   2) Update `onUpdateRef`.\n  //   3) Update listeners for `AnimatedEvent` props.\n  //\n  // Ideally, each of these would be separat \"effects\" so that they are not\n  // unnecessarily re-run when irrelevant dependencies change. For example, we\n  // should be able to hoist all `AnimatedEvent` props and only do #3 if either\n  // the `AnimatedEvent` props change or `instance` changes.\n  //\n  // But there is no way to transparently compose three separate callback refs,\n  // so we just combine them all into one for now.\n  var refEffect = useCallback(instance => {\n    // NOTE: This may be called more often than necessary (e.g. when `props`\n    // changes), but `setNativeView` already optimizes for that.\n    node.setNativeView(instance);\n\n    // NOTE: This callback is only used by the JavaScript animation driver.\n    onUpdateRef.current = () => {\n      // Schedule an update for this component to update `reducedProps`,\n      // but do not compute it immediately. If a parent also updated, we\n      // need to merge those new props in before updating.\n      scheduleUpdate();\n    };\n    var target = getEventTarget(instance);\n    var events = [];\n    for (var propName in props) {\n      var propValue = props[propName];\n      if (propValue instanceof AnimatedEvent && propValue.__isNative) {\n        propValue.__attach(target, propName);\n        events.push([propName, propValue]);\n      }\n    }\n    return () => {\n      onUpdateRef.current = null;\n      for (var _i = 0, _events = events; _i < _events.length; _i++) {\n        var _events$_i = _events[_i],\n          _propName = _events$_i[0],\n          _propValue = _events$_i[1];\n        _propValue.__detach(target, _propName);\n      }\n    };\n  }, [props, node]);\n  var callbackRef = useRefEffect(refEffect);\n  return [reduceAnimatedProps(node), callbackRef];\n}\nfunction reduceAnimatedProps(node) {\n  // Force `collapsable` to be false so that the native view is not flattened.\n  // Flattened views cannot be accurately referenced by the native driver.\n  return _objectSpread(_objectSpread({}, node.__getValue()), {}, {\n    collapsable: false\n  });\n}\n\n/**\n * Manages the lifecycle of the supplied `AnimatedProps` by invoking `__attach`\n * and `__detach`. However, this is more complicated because `AnimatedProps`\n * uses reference counting to determine when to recursively detach its children\n * nodes. So in order to optimize this, we avoid detaching until the next attach\n * unless we are unmounting.\n */\nfunction useAnimatedPropsLifecycle(node) {\n  var prevNodeRef = useRef(null);\n  var isUnmountingRef = useRef(false);\n  useEffect(() => {\n    // It is ok for multiple components to call `flushQueue` because it noops\n    // if the queue is empty. When multiple animated components are mounted at\n    // the same time. Only first component flushes the queue and the others will noop.\n    NativeAnimatedHelper.API.flushQueue();\n  });\n  useLayoutEffect(() => {\n    isUnmountingRef.current = false;\n    return () => {\n      isUnmountingRef.current = true;\n    };\n  }, []);\n  useLayoutEffect(() => {\n    node.__attach();\n    if (prevNodeRef.current != null) {\n      var prevNode = prevNodeRef.current;\n      // TODO: Stop restoring default values (unless `reset` is called).\n      prevNode.__restoreDefaultValues();\n      prevNode.__detach();\n      prevNodeRef.current = null;\n    }\n    return () => {\n      if (isUnmountingRef.current) {\n        // NOTE: Do not restore default values on unmount, see D18197735.\n        node.__detach();\n      } else {\n        prevNodeRef.current = node;\n      }\n    };\n  }, [node]);\n}\nfunction getEventTarget(instance) {\n  return typeof instance === 'object' && typeof (instance == null ? void 0 : instance.getScrollableNode) === 'function' ?\n  // $FlowFixMe[incompatible-use] - Legacy instance assumptions.\n  instance.getScrollableNode() : instance;\n}\n\n// $FlowFixMe[unclear-type] - Legacy instance assumptions.\nfunction isFabricInstance(instance) {\n  var _instance$getScrollRe;\n  return hasFabricHandle(instance) ||\n  // Some components have a setNativeProps function but aren't a host component\n  // such as lists like FlatList and SectionList. These should also use\n  // forceUpdate in Fabric since setNativeProps doesn't exist on the underlying\n  // host component. This crazy hack is essentially special casing those lists and\n  // ScrollView itself to use forceUpdate in Fabric.\n  // If these components end up using forwardRef then these hacks can go away\n  // as instance would actually be the underlying host component and the above check\n  // would be sufficient.\n  hasFabricHandle(instance == null ? void 0 : instance.getNativeScrollRef == null ? void 0 : instance.getNativeScrollRef()) || hasFabricHandle(instance == null ? void 0 : instance.getScrollResponder == null ? void 0 : (_instance$getScrollRe = instance.getScrollResponder()) == null ? void 0 : _instance$getScrollRe.getNativeScrollRef == null ? void 0 : _instance$getScrollRe.getNativeScrollRef());\n}\n\n// $FlowFixMe[unclear-type] - Legacy instance assumptions.\nfunction hasFabricHandle(instance) {\n  var _instance$_internalIn, _instance$_internalIn2;\n  // eslint-disable-next-line dot-notation\n  return (instance == null ? void 0 : (_instance$_internalIn = instance['_internalInstanceHandle']) == null ? void 0 : (_instance$_internalIn2 = _instance$_internalIn.stateNode) == null ? void 0 : _instance$_internalIn2.canonical) != null;\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}